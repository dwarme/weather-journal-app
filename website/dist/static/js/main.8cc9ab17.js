(()=>{"use strict";const e={weather:{data:async function(e){const t=await fetch(e);if(200!==t.status)throw new Error("An error occured");return t.json()}},userFeedback:{all:async function(){const e=await fetch("/all");if(200!==e.status)throw new Error("An error occured");return e.json()},add:async function(e){let{date:t,temp:n,feelings:a}=e;const r=JSON.stringify({date:t,temp:n,feelings:a});if(201!==(await fetch("/add",{method:"POST",body:r,headers:{"content-type":"application/json"}})).status)throw new Error("An error occured")}}},t=e,n=document.getElementById("zip"),a=document.getElementById("feelings"),r=document.getElementById("generate");let o="",c="";function i(e,t){let n;return function(){for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];clearTimeout(n),n=setTimeout((()=>e.apply(this,r)),t)}}async function d(){try{const e=await t.userFeedback.all(),n=Object.keys(e);if(0===n.length)return;const a=e[n[n.length-1]];document.getElementById("temp").innerHTML=Math.round(a.temp)+" degrees",document.getElementById("content").innerHTML=a.feelings,document.getElementById("date").innerHTML=a.date}catch(e){console.warn(e)}}function s(e){r.innerHTML=e?"Loading ...":"Generate"}function u(){r.disabled=!0}function l(){r.disabled=!1}function f(){Boolean(o)&&Boolean(c)?l():u()}const m=i((function(){o=n.value.trim(),f()}),300),g=i((function(){c=a.value.trim(),f()}),300);n.addEventListener("change",m),a.addEventListener("change",g),r.addEventListener("click",(async function(){u(),s(!0);try{const e=`?zip=${o},US&appid=0a6f3c93694897d03df8bd5af22ad641&units=imperial`,r=await t.weather.data("https://api.openweathermap.org/data/2.5/weather"+e),{temp:i}=r.main,s=function(){let e=new Date;return e.getMonth()+"."+e.getDate()+"."+e.getFullYear()}();await t.userFeedback.add({date:s,temp:i,feelings:c}),u(),n.value="",o="",a.value="",c="",d()}catch(e){console.warn(e),alert("An error occured")}finally{l(),s(!1)}})),d()})();